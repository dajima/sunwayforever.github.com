<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Android Applications</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="Android Applications"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2013-05-17T12:24+0800"/>
<meta name="author" content="sunway"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style>    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012  Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>

</head>
<body>

<div id="preamble">

</div>

<div id="content">
<h1 class="title">Android Applications</h1>


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1 Android App</a>
<ul>
<li><a href="#sec-1-1">1.1 Contacts</a></li>
<li><a href="#sec-1-2">1.2 MMS</a></li>
<li><a href="#sec-1-3">1.3 Phone</a></li>
<li><a href="#sec-1-4">1.4 VCard</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Android App</h2>
<div class="outline-text-2" id="text-1">


</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Contacts</h3>
<div class="outline-text-3" id="text-1-1">

</div>

</div>

<div id="outline-container-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> MMS</h3>
<div class="outline-text-3" id="text-1-2">

</div>

</div>

<div id="outline-container-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> Phone</h3>
<div class="outline-text-3" id="text-1-3">

</div>

</div>

<div id="outline-container-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> VCard</h3>
<div class="outline-text-3" id="text-1-4">


</div>

<div id="outline-container-1-4-1" class="outline-4">
<h4 id="sec-1-4-1"><span class="section-number-4">1.4.1</span> import from .vcf</h4>
<div class="outline-text-4" id="text-1-4-1">


</div>

<div id="outline-container-1-4-1-1" class="outline-5">
<h5 id="sec-1-4-1-1"><span class="section-number-5">1.4.1.1</span> Parser</h5>
<div class="outline-text-5" id="text-1-4-1-1">

<p>import 的过程从 parser 开始:
</p>


<pre class="src src-java">VCardParser.parse(InputStream, VCardInterpreter)
  interpreter.onVCardStarted()
  parseOneVCard()
    parseItems()
      parseItem()
        interpreter.onPropertyCreated()
  interpreter.onVCardEnded()

</pre>


<p>
parse 在 parse 过程中
</p><ul>
<li>检测到V CARD:BEGIN 时, 调用 interpreter.onVCardStarted
</li>
<li>检测到V CARD:END 时, 调用 interpreter.onVCardEnded
</li>
<li>检测到其它 property 时, 调用 interpreter.onPropertyCreated
</li>
</ul>


<p>
parser 只负责 parse, parse 出来的信息的保存和处理由 interpreter 决定
</p>
</div>

</div>

<div id="outline-container-1-4-1-2" class="outline-5">
<h5 id="sec-1-4-1-2"><span class="section-number-5">1.4.1.2</span> Interpreter</h5>
<div class="outline-text-5" id="text-1-4-1-2">

<p>import 时使用的 interpreter 是 VCardEntryConstructor, 它的三个函数:
</p><ul>
<li>onVCardStarted
</li>
<li>onVCardEnded
</li>
<li>onPropertyCreated
</li>
</ul>

<p>会负责保存 parser 的信息到 VCardEntry, 在 parse 结束 (onVCardEnded) 时, 由
VCardEntryHandler去处理 (例如: 保存到数据库)
</p>
</div>

</div>

<div id="outline-container-1-4-1-3" class="outline-5">
<h5 id="sec-1-4-1-3"><span class="section-number-5">1.4.1.3</span> commiter</h5>
<div class="outline-text-5" id="text-1-4-1-3">

<p>VCardEntryCommitter 继承自 VCardEntryHandler, 其实现的三个函数负责将 interpreter
保存的 VCardEntry commit 到数据库中:
</p><ul>
<li>onStart
</li>
<li>onEnd
</li>
<li>onEntryCreated
</li>
</ul>


<p>
其中 onEntryCreated 真正负责将 interpreter 保存的 VCardEntry 写到数据库
</p>
</div>
</div>

</div>

<div id="outline-container-1-4-2" class="outline-4">
<h4 id="sec-1-4-2"><span class="section-number-4">1.4.2</span> export to .vcf</h4>
<div class="outline-text-4" id="text-1-4-2">

<p>相比 import from .vcf,  export 简单的多, 因为不需要 parse.
</p>

</div>

<div id="outline-container-1-4-2-1" class="outline-5">
<h5 id="sec-1-4-2-1"><span class="section-number-5">1.4.2.1</span> VCardComposer</h5>
<div class="outline-text-5" id="text-1-4-2-1">

<p>基本上只是调用 VCardComposer 查询数据库, 将数据拼成一个 .vcf 就可以了.
</p></div>
</div>
</div>
</div>
</div>
</div>

<div id="postamble">
<p class="date">Date: 2013-05-17T12:24+0800</p>
<p class="author">Author: sunway</p>
<p class="creator"><a href="http://orgmode.org">Org</a> version 7.9.1 with <a href="http://www.gnu.org/software/emacs/">Emacs</a> version 23</p>
<a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a>

</div>
</body>
</html>
