<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Unicode</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="Unicode"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2013-05-21T14:33+0800"/>
<meta name="author" content="sunway"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style>    <link rel="stylesheet" type="text/css" href="/stylesheets/main.css" media="screen" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012  Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>

</head>
<body>

<div id="preamble">

</div>

<div id="content">
<h1 class="title">Unicode</h1>


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1 Unicode</a>
<ul>
<li><a href="#sec-1-1">1.1 Charset</a></li>
<li><a href="#sec-1-2">1.2 Encoding</a></li>
<li><a href="#sec-1-3">1.3 UTF-16</a></li>
<li><a href="#sec-1-4">1.4 UTF-8</a></li>
<li><a href="#sec-1-5">1.5 Unicode and Java</a></li>
</ul>
</li>
<li><a href="#sec-2">2 ICU</a>
<ul>
<li><a href="#sec-2-1">2.1 Collator</a></li>
<li><a href="#sec-2-2">2.2 Normalizer</a></li>
</ul>
</li>
<li><a href="#sec-3">3 Reference</a></li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Unicode</h2>
<div class="outline-text-2" id="text-1">

<p>Representing text-format data in computers is a matter of:
</p><ol>
<li>repertoires: defining a set of characters
   defining a repertoires of an <b>unordered</b> collection of characters
</li>
<li>charset: assigning each character of the repertoires a number (code point)
   a coded character set (charset) maps characters from the repertoires to numeric values
</li>
<li>encoding: assigning the number a bit representation
</li>
</ol>


<p>   
thus, we should tell `charset` and `encoding` apart when talking about
text-format data. but for some simple text-format like ASCII, the two concepts
are basically the same: ASCII is both a charset and an encoding scheme
</p>

</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Charset</h3>
<div class="outline-text-3" id="text-1-1">

<p>ASCII uses 7 bit to encode 128 characters.
LATIN-1 uses 8 bit to encode 256 characters.
</p>
<p>
Unicode is a <b>charset</b>, so when we talking about unicode, temporary forget the
encoding schemes like `utf`, `ucs`&hellip;
</p>
<p>
The first version of unicode used 16-bit code points, which allowed for
encoding 65536 characters.
</p>
<p>
Starting with unicode 2.0, the Unicode standard began assigning code points
from 0-10ffff (which requires 21 bits)
</p>
<p>
The first 128 characters of unicode is assigned to the same characters in ASCII
charset, and the same is true for LATIN-1, thus ASCII and LATIN-1 are subsets
of unicode.  Note that we are talking about `charset`, for various encoding 
schemes, MAYBE the conclusion doesn't apply.
</p>
</div>

</div>

<div id="outline-container-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Encoding</h3>
<div class="outline-text-3" id="text-1-2">

<p>unicode assigns characters a number from 0-10ffff, such a character number is
called a `code point`, these `code point` are just non-negative integer, they
don't have an implicit binary representation or a width of 21 bits &ndash; binary
representation and unit width is defined by encoding scheme.
</p>
<p>
there are 3 encoding schemes:
</p><ol>
<li>UTF-16, the default encoding scheme, map code point to either one or two
   16-bit integers
</li>
<li>UTF-8 offer backward compatibility with ASCII-based APIs and protocols<sup><a class="footref" name="fnr-.1" href="#fn-.1">1</a></sup>, A
   code pointer is mapped to 1,2,3 or 4 bytes.
</li>
<li>UTF-32 is the simplest but most memory intensive encoding: it use a fixed 32
   bits integer to map a code point.
</li>
</ol>


<p>
Both UTF-16 and UTF-8 are variable length encoding schemes.
</p>
<p>
for input/output, encoding scheme need to define a byte serialization of
text. UTF-8 is itself serializable because it is byte-based. for each of UTF-16
and UTF-32, there are two variants defined: big endian and little endian , the
corresponding encoding scheme is called UTF-16BE, UTF-16LE, UTF-32BE, UTF-32LE.
</p>
<p>
TODO: BOM (Byte Order Mark)
</p>

<p>
For historical reasons, there are also another two encoding schemes:
</p><ol>
<li>UCS2

<p>
   UCS2 is basically the same with UTF-16 of the first unicode version: it is a
   fixed length encoding scheme, using 16 bits to encoding code points between
   0-ffff, it is deprecated because it can't encode code points between
   10000-10ffff
</p>
</li>
<li>UCS4

<p>
   UCS4 is the same with UTF-32
</p></li>
</ol>


</div>

</div>

<div id="outline-container-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> UTF-16</h3>
<div class="outline-text-3" id="text-1-3">

<p>UTF-16 is the default encoding form of Unicode. it is a variable length
encoding scheme: 
</p><ul>
<li>for code points between 0-ffff (Basic Multilingual Plane, BMP), UTF-16 using one
  16-bit unit to encode
</li>
<li>for code points between 10000-10ffff (Supplementary Multilingual Plane, SMP),
  UTF-16 using two 16-bit unit to encode code points between 10000-10ffff, are
  encoded with two code units, called `surrogates pair`, the first surrogates in
  the pair must be in the range of D800-DBFF, and the second one must be in the
  range of DC00-DFFF, The coide point values D800-DFFF are just set aside for
  this mechanism and will never, by themselves, be assigned any characters.

<p>
  For historical reason, sometimes UCS2 is taken for UTF-16. e.g. JAVA alleged
  that a char represent a UTF-16 character, in face, JAVA is using the older
  UTF-16 , or the deprecated UCS2, thus a char in JAVA can't represent code
  point between 10000-10FFFF!
</p></li>
</ul>


</div>

<div id="outline-container-1-3-1" class="outline-4">
<h4 id="sec-1-3-1"><span class="section-number-4">1.3.1</span> the UTF-16 encoding</h4>
<div class="outline-text-4" id="text-1-3-1">

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption>supplementary code points (10000-10ffff)</caption>
<colgroup><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left">lead\tail</th><th scope="col" class="left">DC00</th><th scope="col" class="left">DC01</th><th scope="col" class="left">&hellip;</th><th scope="col" class="left">DFFF</th></tr>
</thead>
<tbody>
<tr><td class="left">D800</td><td class="left">10000</td><td class="left">10001</td><td class="left">&hellip;</td><td class="left">103ff</td></tr>
<tr><td class="left">D801</td><td class="left">10400</td><td class="left">10401</td><td class="left">&hellip;</td><td class="left">107ff</td></tr>
<tr><td class="left">&hellip;</td><td class="left">&hellip;</td><td class="left">&hellip;</td><td class="left">&hellip;</td><td class="left">&hellip;</td></tr>
<tr><td class="left">DBFF</td><td class="left">10fc00</td><td class="left">10fc01</td><td class="left">&hellip;</td><td class="left">10ffff</td></tr>
</tbody>
</table>


</div>
</div>

</div>

<div id="outline-container-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> UTF-8</h3>
<div class="outline-text-3" id="text-1-4">

<p>To meet the requirement of bye-oriented, ASCII-based system, the unicode
defines UTF-8, UTF-8 is a variable-width encoding scheme. UTF-8 will encode
character to 1,2,3 or 4 bytes.
</p>

</div>

<div id="outline-container-1-4-1" class="outline-4">
<h4 id="sec-1-4-1"><span class="section-number-4">1.4.1</span> the UTF-8 encoding</h4>
<div class="outline-text-4" id="text-1-4-1">

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption>UHF-8 encoding</caption>
<colgroup><col class="right" /><col class="left" /><col class="right" /><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="right">Bits</th><th scope="col" class="left">Last code point</th><th scope="col" class="right">Byte 1</th><th scope="col" class="left">Byte 2</th><th scope="col" class="left">Byte 3</th><th scope="col" class="left">Byte 4</th><th scope="col" class="left">Byte 5</th><th scope="col" class="left">Byte 6</th></tr>
</thead>
<tbody>
<tr><td class="right">7</td><td class="left">U+007F</td><td class="right">0xxxxxxx</td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td></tr>
<tr><td class="right">11</td><td class="left">U+07FF</td><td class="right">110xxxxx</td><td class="left">10xxxxxx</td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td></tr>
<tr><td class="right">16</td><td class="left">U+FFFF</td><td class="right">1110xxxx</td><td class="left">10xxxxxx</td><td class="left">10xxxxxx</td><td class="left"></td><td class="left"></td><td class="left"></td></tr>
<tr><td class="right">21</td><td class="left">U+1FFFFF</td><td class="right">11110xxx</td><td class="left">10xxxxxx</td><td class="left">10xxxxxx</td><td class="left">10xxxxxx</td><td class="left"></td><td class="left"></td></tr>
<tr><td class="right">26</td><td class="left">&hellip;</td><td class="right">&hellip;</td><td class="left">&hellip;</td><td class="left">&hellip;</td><td class="left">&hellip;</td><td class="left">&hellip;</td><td class="left"></td></tr>
<tr><td class="right">&hellip;</td><td class="left"></td><td class="right"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td></tr>
</tbody>
</table>


<p>
What we can read from this table:
</p><ol>
<li>UTF-8 is compilable with ASCII and thus compilable with those legacy
   ASCII-based systems
</li>
<li>UTF-8 is a prefix<sup><a class="footref" name="fnr-.2" href="#fn-.2">2</a></sup> encoding scheme
</li>
<li>4 bytes UTF-8 is enough to encode all the 21 bit unicode code points.
</li>
<li>Characters U+0800 through U+FFFF use three bytes in UTF-8, but only two in
   UTF-16. As a result, text in (for example) Chinese, Japanese or Hindi could
   take more space in UTF-8
</li>
</ol>


</div>
</div>

</div>

<div id="outline-container-1-5" class="outline-3">
<h3 id="sec-1-5"><span class="section-number-3">1.5</span> Unicode and Java</h3>
<div class="outline-text-3" id="text-1-5">

<p>Java internally use UTF-16 to represent `Character` and `String`, BUT, since
UTF-16 is a variable-width encoding, How to represent a SMP UTF-16 using Java
`Character` class?
</p>
<p>
In fact, `Character` literal can only represent UCS2 code units, i.e. they are limited to
values from 0000-ffff, supplementary characters (10000-10ffff) must be
represented as a surrogates pair within a char sequence or as in integer.
</p>



<pre class="src src-java"><span style="color: #b58900;">char</span> <span style="color: #268bd2;">c</span>=<span style="color: #2aa198;">'\u1234'</span>; <span style="color: #586e75; font-style: italic;">// </span><span style="color: #586e75; font-style: italic;">ok</span>
<span style="color: #b58900;">char</span> <span style="color: #268bd2;">c</span>=<span style="color: #2aa198;">'\u10001'</span>; <span style="color: #586e75; font-style: italic;">// </span><span style="color: #586e75; font-style: italic;">error</span>
<span style="color: #b58900;">String</span> <span style="color: #268bd2;">s</span>=<span style="color: #2aa198;">"\u10001"</span>; <span style="color: #586e75; font-style: italic;">// </span><span style="color: #586e75; font-style: italic;">error</span>
<span style="color: #b58900;">String</span> <span style="color: #268bd2;">s</span>=<span style="color: #2aa198;">"\ud801\ud802"</span>; <span style="color: #586e75; font-style: italic;">// </span><span style="color: #586e75; font-style: italic;">ok</span>
<span style="color: #b58900;">char</span> [] <span style="color: #268bd2;">chars</span>=Character.toChars(0x10001);<span style="color: #586e75; font-style: italic;">// </span><span style="color: #586e75; font-style: italic;">ok</span>
</pre>


<p>
Java String class and Character class has a lot of methods to cope with code
point, especially for supplementary characters, when dealing with supplementary
characters, we must take care.
</p>



<pre class="src src-java"><span style="color: #b58900;">String</span> <span style="color: #268bd2;">s</span>=<span style="color: #859900;">new</span> <span style="color: #b58900;">String</span>(<span style="color: #859900;">new</span> <span style="color: #b58900;">int</span>[] {0x10001},0,1);
System.out.println(<span style="color: #2aa198;">"s.length:"</span>+s.length()); <span style="color: #586e75; font-style: italic;">// </span><span style="color: #586e75; font-style: italic;">output: 2</span>
<span style="color: #859900;">for</span> (<span style="color: #b58900;">int</span> <span style="color: #268bd2;">i</span>=0;i&lt;s.<span style="color: #b58900;">length</span>();++i) {
    System.out.printf(<span style="color: #2aa198;">"cp: 0x%x\n"</span>,s.codePointAt(i));
}
<span style="color: #586e75; font-style: italic;">// </span><span style="color: #586e75; font-style: italic;">output: 0x10001</span>
<span style="color: #586e75; font-style: italic;">//         </span><span style="color: #586e75; font-style: italic;">0xdc01</span>
System.out.println(<span style="color: #2aa198;">"cp count:"</span>+s.codePointCount()); <span style="color: #586e75; font-style: italic;">// </span><span style="color: #586e75; font-style: italic;">output: 1</span>

<span style="color: #b58900;">boolean</span> Character.<span style="color: #268bd2;">isHighSurrogate</span>(<span style="color: #b58900;">char</span> <span style="color: #268bd2;">c</span>);
<span style="color: #b58900;">boolean</span> Character.<span style="color: #268bd2;">isLowSurrogate</span>(<span style="color: #b58900;">char</span> <span style="color: #268bd2;">c</span>);
<span style="color: #b58900;">int</span> Character.<span style="color: #268bd2;">toCodePoint</span>(<span style="color: #b58900;">char</span> <span style="color: #268bd2;">high</span>, <span style="color: #b58900;">char</span> <span style="color: #268bd2;">low</span>);
<span style="color: #b58900;">char</span> [] Character.<span style="color: #268bd2;">toChars</span>(<span style="color: #b58900;">int</span> <span style="color: #268bd2;">codePoint</span>);

</pre>


</div>
</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> ICU</h2>
<div class="outline-text-2" id="text-2">


</div>

<div id="outline-container-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Collator</h3>
<div class="outline-text-3" id="text-2-1">

</div>

</div>

<div id="outline-container-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> Normalizer</h3>
<div class="outline-text-3" id="text-2-2">

</div>
</div>

</div>

<div id="outline-container-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Reference</h2>
<div class="outline-text-2" id="text-3">

<ul>
<li><a href="http://www.unicode.org/charts/unihan.html">Unihan Data Lookup Tool</a>
</li>
<li><a href="http://en.wikipedia.org/wiki/Unicode">Wikipedia:Unicode</a>
</li>
<li><a href="http://www.unicode.org/">Unicode Consortium</a>
</li>
<li><a href="http://cldr.unicode.org/">Unicode CLDR</a>
</li>
<li><a href="http://site.icu-project.org/">ICU Project</a>
</li>
<li><a href="http://www.unicode.org/reports/tr10/">UCA:Unicode Collation Algorithm</a>
</li>
<li><a href="http://userguide.icu-project.org/unicode">Unicode Basic from ICU</a>
</li>
</ul>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">
<p class="footnote"><sup><a class="footnum" name="fn-.1" href="#fnr-.1">1</a></sup> ASCII-base system will take 0x0 as the `end of data` mark, e.g. `char * `
in C, while UTF-8 encoding scheme doesn't use 0x0 as code unit.
</p>


<p class="footnote"><sup><a class="footnum" name="fn-.2" href="#fnr-.2">2</a></sup> A prefix code is a type of code system (typical a variable-length code)
that there is no valid code word in the system that is a prefix (start) of any
other valid code word in the set. For example, a code with code words {9, 59,
55} has the prefix property; a code consisting of {9, 5, 59, 55} does
not. <a href="http://en.wikipedia.org/wiki/Prefix_code">Wikipedia: prefix code</a>
</p></div>
</div>

</div>
</div>
</div>

<div id="postamble">
<p class="date">Date: 2013-05-21T14:33+0800</p>
<p class="author">Author: sunway</p>
<p class="creator"><a href="http://orgmode.org">Org</a> version 7.9.1 with <a href="http://www.gnu.org/software/emacs/">Emacs</a> version 23</p>
<a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a>

</div>
</body>
</html>
